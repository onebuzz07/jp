@extends('frontend.layouts.app')

@section('content')
    {{--  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/js/bootstrap-datepicker.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/css/bootstrap-datepicker3.css"/>  --}}
    <link rel="stylesheet" href="https://cdn.datatables.net/select/1.2.4/css/select.bootstrap.min.css">
    <!-- [Start] New Plate Modal -->
    <div class="modal fade" id="modalNew" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-custom" role="document">
            <div class="modal-content">
                <div class="modal-header modal-header-custom">
                    <h3 class="modal-title modal-title-custom" id="exampleModalLongTitle">Add New</h3>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group row">
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Request By</span>
                                    <span class="input-group-addon input-group-addon-custom-modal-required">*</span>
                                    <select class="selectpicker form-control form-control-custom-modal" id="select_request_by">
                                    <option></option>
                                        @foreach ($select_users as $select_user)
                                            <option>{{ $select_user->email }}</option>
                                        @endforeach
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Request Date</span>
                                    <span class="input-group-addon input-group-addon-custom-modal-required">*</span>
                                    <div class='input-group date form-control-custom-modal' id='datetimepicker1'>
                                        <input type='text' class="form-control" id="date_request"/>
                                        <span class="input-group-addon">
                                            <i class="fa fa-calendar"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Customer</span>
                                    <span class="input-group-addon input-group-addon-custom-modal-required">*</span>
                                    <select class="selectpicker form-control form-control-custom-modal" id="select_cust_no" data-live-search="true">
                                        {{--  <optgroup label="New">
                                            <option id="editable_cust" class="editable" value="new">New Customer</option>
                                        </optgroup>  --}}
                                        <option></option>
                                        @foreach ($select_cust_no_masters as $select_cust_no_master)
                                            <option>{{ $select_cust_no_master->cust_no }}</option>
                                        @endforeach
                                        {{--  <input id="select_cust_no_new" class="editOption form-control form-control-custom-modal" style="display:none;"></input>  --}}
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">FG Code</span>
                                    <span class="input-group-addon input-group-addon-custom-modal-required">*</span>
                                    <select class="selectpicker form-control form-control-custom-modal" id="select_part_no" data-live-search="true">  
                                        {{--  <optgroup label="New">
                                            <option id="editable_part" class="editable" value="new">New FG Code</option>
                                        </optgroup>  --}}
                                        <option></option>
                                        @foreach ($select_part_no_masters as $select_part_no_master)
                                            <option>{{ $select_part_no_master->part_no }}</option>
                                        @endforeach
                                        
                                        {{--  <input id="select_part_no_new" class="editOption form-control form-control-custom-modal" style="display:none;"></input>  --}}
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Plate Type</span>
                                    <select class="selectpicker form-control form-control-custom-modal" id="select_plate_type">
                                        <option></option>
                                        <option>H</option>
                                        <option>R</option>
                                        <option>KBA</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Quantity</span>
                                    <input class="form-control currency form-control-custom-modal text-right" value="0" min="0" type="number" id="input_qty" />
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">WO ID</span>
                                    <input type="text" class="form-control form-control-custom-modal" id="text_wo_id">
                                     {{--  <select class="selectpicker form-control form-control-custom-modal" id="text_wo_id">
                                        <option></option>
                                        @foreach ($select_type_vendors as $select_type_vendor)
                                            <option>{{ $select_type_vendor->value }}</option>
                                        @endforeach
                                    </select>  --}}
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Require Date</span>
                                    <span class="input-group-addon input-group-addon-custom-modal-required">*</span>
                                    <div class='input-group date form-control-custom-modal' id='datetimepicker2'>
                                        <input type='text' class="form-control" id="date_require"/>
                                        <span class="input-group-addon">
                                            <i class="fa fa-calendar"></i>
                                        </span>
                                    </div>
                                </div>
                            </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-12">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Remarks</span>
                                    <textarea class="form-control" style="width:610px" id="text_remark"></textarea>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button id="btnModalNewClose" type="button" class="btn btn-primary" title="Cancel"><i class="fa fa-ban"></i></button>
                    <button id="btnModalNewSave" type="button" class="btn btn-primary" title="Save"><i class="fa fa-floppy-o"></i></button>
                </div>
            </div>
        </div>
    </div>
    <!-- [End] New Plate Modal -->

    <!-- [Start] Modify Plate Modal -->
    <div class="modal fade" id="modalModify" tabindex="-1" role="dialog" data-backdrop="static" data-keyboard="false" aria-labelledby="exampleModalLongTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-custom" role="document">
            <div class="modal-content">
                <div class="modal-header modal-header-custom">
                    <h3 class="modal-title modal-title-custom" id="modalModifyTitle">Modify</h3>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="form-group row">
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Printer Type</span>
                                    <select class="selectpicker form-control form-control-custom-modal" id="select_plate_type_modify">
                                        <option></option>
                                        <option>H</option>
                                        <option>R</option>
                                        <option>KBA</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Size</span>
                                    <select class="selectpicker form-control form-control-custom-modal" id="select_plate_size_modify">
                                        <option></option>
                                        <option>785</option>
                                        <option>790</option>
                                        <option>795</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Type Vendor</span>
                                   {{--   <input type="text" class="form-control form-control-custom-modal" id="text_type_vendor_modify">  --}}
                                    <select class="form-control form-control-custom-modal" id="text_type_vendor_modify">
                                        <option></option>
                                        @foreach ($select_type_vendors as $select_type_vendor)
                                            <option>{{ $select_type_vendor->value }}</option>
                                        @endforeach
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Location</span>
                                    {{--  <input type="text" class="form-control form-control-custom-modal" id="text_location_modify">  --}}
                                    <select disabled class="form-control form-control-custom-modal" id="text_location_modify">
                                        <option></option>
                                        @foreach ($select_locs as $select_loc)
                                            <option>{{ $select_loc->value }}</option>
                                        @endforeach
                                    </select>
                                </div>
                            </div>
                        </div>
                       
                        <div class="form-group row">
                            {{--  <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Quantity</span>
                                    <input class="form-control currency form-control-custom-modal text-right" value="0" min="0" type="number" id="input_qty_modify" />
                                    
                                </div>
                            </div>  --}}
                             <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Print Req</span>
                                    <select class="form-control form-control-custom-modal" id="select_print_req_modify">
                                        <option></option>
                                        <option>Cover</option>
                                        <option>Text</option>
                                        <option>Sticker</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Life Span</span>
                                    <input class="form-control currency form-control-custom-modal text-right" value="0" min="0" type="number" id="input_qty_life_modify" />
                                </div>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Film Description</span>
                                    <input type="text" class="form-control form-control-custom-modal" id="text_film_desc_modify">
                                    {{--  <select class="form-control form-control-custom-modal" id="select_film_desc">
                                    <option></option>
                                    </select>  --}}
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Film Quantity</span>
                                    <input class="form-control currency form-control-custom-modal text-right" value="0" min="0" type="number" id="input_qty_film_modify" />
                                </div>
                            </div>
                        </div>
                        {{--  <div class="form-group row">
                            <div class="col-sm-6">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Print Req</span>
                                    <select class="form-control form-control-custom-modal" id="select_print_req_modify">
                                        <option></option>
                                        <option>Cover</option>
                                        <option>Text</option>
                                        <option>Sticker</option>
                                    </select>
                                </div>
                            </div>
                        </div>  --}}
                        <div class="form-group row">
                            <div class="col-sm-12">
                                <div class="input-group">
                                    <span class="input-group-addon input-group-addon-custom-modal" id="sizing-addon2">Remarks</span>
                                    <textarea class="form-control" style="width:620px" id="text_remark_modify"></textarea>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button id="btnModalModifyClose" type="button" class="btn btn-primary" title="Cancel"><i class="fa fa-ban"></i></button>
                    <button id="btnModalModifySave" type="button" class="btn btn-primary" title="Save"><i class="fa fa-floppy-o"></i></button>
                </div>
            </div>
        </div>
    </div>
    <!-- [End] Modify Plate Modal -->

   
    <div class="container-fluid">
        <div class="panel panel-info">
            @include('frontend.ctp.includes.nav', ['mainTitle' => 'CTP Department / Request'])
            <br>
            <div class="panel-body">
                {{-- [Start] Row 1 Selctions --}}
                <div class="row">
                    <div class="col-lg-3">
                    <div class="input-group">
                        <span class="input-group-addon input-group-addon-custom" id="sizing-addon2" >Request By</span>
                        <select class="selectpicker form-control" id="select_user_form" data-live-search="true">
                        <option></option>
                            @foreach ($select_users as $select_user)
                                <option>{{ $select_user->email }}</option>
                            @endforeach
                        </select>
                    </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="input-group">
                            <span class="input-group-addon input-group-addon-custom" id="sizing-addon2">Customer</span>
                            <select class="selectpicker form-control" id="select_cust_no_form" data-live-search="true">
                                <option></option>  
                                @foreach ($select_cust_nos as $select_cust_no)
                                    <option>{{ $select_cust_no->cust_no }}</option>
                                @endforeach  
                            </select>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="input-group">
                            <span class="input-group-addon input-group-addon-custom" id="sizing-addon2">FG Code</span>
                            <select class="selectpicker form-control" id="select_part_no_form" data-live-search="true">
                            <option></option>
                                @foreach ($select_part_nos as $select_part_no)
                                    <option>{{ $select_part_no->part_no }}</option>
                                @endforeach
                            </select>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="input-group">
                            <span class="input-group-addon input-group-addon-custom" id="sizing-addon2">Status</span>
                            <select class="selectpicker form-control" id="select_status_form">
                                <option></option>
                                <option>New</option>
                                <option>Created</option>
                                <option>History</option>
                            </select>
                        </div>
                    </div>
                </div> 
                {{-- [End] Row 1 Selctions --}}
                <br>
                {{-- [Start] Row 2 Buttons --}}
                <div class="row">
                    <div class="col-lg-6">
                        <span>
                            <button type="button" id="btnMoldInfoSearch" class="btn btn-primary" title="Search"><i class="fa fa-search"></i></button>                      
                            <button id="btnPlateNew" type="button" class="btn btn-primary" data-toggle="modal" title="New"><i class="fa fa-plus-square-o"></i></button>
                            <button id="btnPlateModify" type="button" class="btn btn-primary" data-toggle="modal" title="Modify"><i class="fa fa-edit"></i></button>
                            <button id="btnPlateDelete" type="button" class="btn btn-primary"><i class="fa fa-trash-o" title="Delete"></i></button> 
                        </span>
                    </div>
                    <div class="col-lg-6">
                    </div>
                </div>
                {{-- [End] Row 2 Buttons --}}
                </br>
                
                 
                
                {{--  [Start] Table  --}}
                <div class="row">
                    <div class="col-lg-12">
                        <div class="dataTables_wrapper"  >
                            <table id="ctp-table" class="table table-striped table-bordered dt-responsive" style="white-space:nowrap;" cellspacing="0" width="100%">
                                <thead  style="background-color:#d9edf7; color:#31708f">
                                <tr>
                                    <th>Req ID</th>
                                    <th>Status</th>
                                    <th>Request By</th>
                                    <th>Request Date</th>
                                    <th>Customer FG Code</th>
                                    <th>WO ID</th>
                                    <th>Customer</th>
                                    <th>Plate Type</th>
                                    <th>Plate Qty</th>
                                    <th>Require Date</th>
                                    <th>Remark</th>
                                    {{--  <th>Completed By</th>
                                    <th>Completed At</th>  --}}
                                </tr>
                                </thead>
                                
                            </table>
                        </div>
                    </div>
                </div>
                {{--  [End] Table  --}}

            </div>
        </div>




    {{ Html::script("https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js") }}
    {{ Html::script("https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap.min.js") }}
    

    <script>
        var oTable;
        var selectedMoldId = undefined;
        var selectedStatus;
        var selectedMoldType;
        var selectedMoldTypeVendor;
        var selectedMoldSize;
        var selectedQty;
        var selectedLocation;
        var selectedQtyLife;
        var selectedPrintReq;
        var selectedFilmDesc;
        var selectedQtyFilm;
        var selectedRemark;
    </script>
    <script>
        $(document).ready(function() {
            $('#datetimepicker1').datetimepicker({
                format: 'DD/MM/YYYY HH:mm',
            });

            $('#datetimepicker2').datetimepicker({
                format: 'DD/MM/YYYY HH:mm',
            });

            $(".selectpicker").selectpicker();
            $(".bootstrap-select").click(function () {
                $(this).addClass("open");
            });
        //var djson = [{"part_no":"1"},{"cust_no":"1"},{"mac_no":"1"},{"cr_date":"1"},
        //                            {"location":"1"},{"description":"1"},{"qty":"1"},{"remark":"1"},{"qty_print":"1"},{"qty_print_bal":"1"}];

        var table = $('#ctp-table').DataTable( {
            "scrollY": false,
            "scrollX": true,
            "sScrollX": "100%",
            "sScrollXInner": "100%",
            /*"bScrollCollapse": true,*/
            "searching": false,
            "lengthChange": false,
            "iDisplayLength":2,
            "retrieve": true,
            select: true,
            //"ajax":djson.json,
            processing: true,
            serverSide: true,
            //ajax:"{!! route('frontend.ctp.anyData') !!}"
            
            ajax: {
                    url: "/ctp/anyDataRequest", 
                    data: function (d) {
                                d.req_by = $('select[id="select_user_form"]').val();
                                d.part_no = $('select[id="select_part_no_form"]').val();
                                d.cust_no = $('select[id="select_cust_no_form"]').val();
                                d.status = $('select[id="select_status_form"]').val();
                            }
            },
            
            columns: [
                        { data: 'req_id'},
                        { data: 'status'},
                        { data: 'req_by'},
                        { data: 'req_date'},
                        { data: 'part_no'},
                        { data: 'wo_id'},
                        { data: 'cust_no'},
                        { data: 'mold_type'},
                        { data: 'qty'},
                        { data: 'require_date'},
                        { data: 'remark'},
                    ]
        });
        $('#ctp-table').on( 'click', 'tr', function () {
            if ( $(this).hasClass('selected') ) {
                    $(this).removeClass('selected');
                    selectedMoldId = undefined;
                    $('#main-table').DataTable().draw();
                    $('#move-table').DataTable().draw();
                    
                }
            else {
                
                table.$('tr.selected').removeClass('selected');
                $(this).addClass('selected');
                if (table.row( this ).data() == undefined){
                    return;
                }
                //alert(table.row( this ).data().mold_id);
                /*
                selectedMoldId = table.row( this ).data().mold_id;
                selectedMoldType = table.row( this ).data().mold_type;
                selectedMoldTypeVendor = table.row( this ).data().mold_type_vendor;
                selectedMoldSize = table.row( this ).data().mold_size;
                selectedQty = table.row( this ).data().qty;
                selectedLocation = table.row( this ).data().location;
                selectedQtyLife = table.row( this ).data().qty_life;
                selectedPrintReq = table.row( this ).data().print_req;
                selectedFilmDesc = table.row( this ).data().film_desc;
                selectedQtyFilm = table.row( this ).data().qty_film;
                selectedStatus = table.row( this ).data().status;
                selectedRemark = table.row( this ).data().remark;*/

              
                
            }
            
        });

     

    } ); 
    </script> 
    
    <script>
    
        
    </script>
    
    <script> 

   

    $(document).ready(function(){
        $("#btnMoldInfoSearch").click(function(){

        
        $.ajax({url: "/ctp/anyDataRequest", data: { part_no: 1 },
                    success: function(result){
                    //alert($('select[id="select_part_no"]').val());
                            oTable = $('#ctp-table').DataTable();
                            //oTable.ajax.reload();
                                oTable.draw();
                                //selectedMoldId = undefined;
                            //result.preventDefault();
                            }});
            
        });
    });

    </script>

    {{--  [Start] Modal New Scripts  --}}
    <script>
    
        $(function(){
            $('#btnPlateNew').click(function(e){
                $("#select_cust_no").val('');
                $('#select_cust_no_new').val('new');
                $('#select_cust_no_new').hide();
                $("#select_part_no").val('');
                $('#select_part_no_new').val('new');
                $('#select_part_no_new').hide();
                $("#select_mac_no").val('');
                $("#select_plate_type").val('');
                $("#select_plate_size").val('');
                $("#text_type_vendor").val('');
                $("#text_type_vendor_new").val('new');
                $('#text_type_vendor_new').hide();
                $("#text_location").val('');
                $("#input_qty").val('0');
                $("#input_qty_life").val('0');
                $("#text_film_desc").val('');
                $("#input_qty_film").val('0');
                $("#select_print_req").val('');
                $("#text_remark").val('');

                $('.selectpicker').selectpicker('refresh');

                e.preventDefault();
                $('#modalNew').modal('show');
            });
        });

        $(function(){
            
            $('#btnModalNewSave').click(function(e){
            e.preventDefault();
            e.stopPropagation();
            $.confirm({
                icon: 'fa fa-info-circle',
                title: 'Saving',
                content: 'Confirm save?',
                type: 'blue', 
                //theme: 'supervan', 
                buttons: {
                    Yes: function(yesButton){
                        
                         $.ajax({
                            url: "/ctp/insert", 
                            data: { 
                                mold_type : 'plate',
                                cust_no: $('select[id="select_cust_no"]').val(), 
                                part_no : $('select[id="select_part_no"]').val(), 
                                mac_no : $('select[id="select_mac_no"]').val(),
                                plate_type : $('select[id="select_plate_type"]').val(),
                                plate_size : $('select[id="select_plate_size"]').val(),
                                type_vendor : $('select[id="text_type_vendor"]').val(),
                                location : $('select[id="text_location"]').val(),
                                print_req : $('select[id="select_print_req"]').val(),
                                qty : $('input[id="input_qty"]').val(),
                                qty_life : $('input[id="input_qty_life"]').val(),
                                film_desc : $('input[id="text_film_desc"]').val(),
                                qty_film : $('input[id="input_qty_film"]').val(),
                                remark : $('textarea[id="text_remark"]').val(),
                                
                            },
                            success: function(result){
                                if (result.error){
                                    //alert(result.error.cust_no[0]);
                                    //alert(result.error);
                                    $.confirm({
                                        //theme: 'supervan',
                                        type: 'red', 
                                        icon: 'fa fa-exclamation-circle',
                                        title: 'Error',
                                        content: result.error,
                                        buttons: { OK : function (){}}
                                    });
                                    return false;
                                }
                                $.confirm({
                                    //theme: 'supervan',
                                    type: 'blue', 
                                    icon: 'fa fa-info-circle',
                                    title: 'Saved',
                                    content: 'Record has been saved. ID : [' + result.success + ']',
                                    buttons: { OK : function (){
                                          $.get('/ctp/selectData', function(data) {
                                            $('#select_plate_id_form').empty().append('<option></option>');
                                            $('#select_plate_id_curr_main').empty().append('<option></option>');
                                            $('#select_plate_id_new_main').empty().append('<option></option>');
                                            $.each(data.mold_id, function(index,subCatObj){
                                                $('#select_plate_id_form').append('<option>'+subCatObj.mold_id+'</option>');
                                                $('#select_plate_id_curr_main').append('<option>'+subCatObj.mold_id+'</option>');
                                                $('#select_plate_id_new_main').append('<option>'+subCatObj.mold_id+'</option>');
                                            }); /*
                                            $('#select_cust_no').empty().append('<option></option>');
                                            $('#select_cust_no_form').empty().append('<option></option>');
                                            $('#select_part_no').empty().append('<option></option>');
                                            $('#select_part_no_form').empty().append('<option></option>');
                                            $('#text_type_vendor').empty().append('<option></option>');
                                            
                                            $.each(data.cust_no, function(index,subCatObj){
                                                $('#select_cust_no').append('<option>'+subCatObj.cust_no+'</option>');
                                                $('#select_cust_no_form').append('<option>'+subCatObj.cust_no+'</option>');
                                            });
                                            $.each(data.part_no, function(index,subCatObj){
                                                $('#select_part_no').append('<option>'+subCatObj.part_no+'</option>');
                                                $('#select_part_no_form').append('<option>'+subCatObj.part_no+'</option>');
                                            });
                                            $.each(data.type_vendor, function(index,subCatObj){
                                                $('#text_type_vendor').append('<option>'+subCatObj.type_vendor+'</option>');
                                            });           */
                                            $('.selectpicker').selectpicker('refresh');
                                            $("#select_plate_id_form").val(result.success);
                                            $('.selectpicker').selectpicker('refresh');
                                            $('#modalNew').modal('hide');
                                            $('.modal-backdrop').remove();
                                            $('#ctp-table').DataTable().draw();
                                        });  
                                        
                                        //$('#modalNew').modal('hide');
                                        //$('.modal-backdrop').remove();
                                        //$('.selectpicker').selectpicker({});
                                        //$('#select_plate_id_form').selectpicker('refresh');
                                        //$("#select_plate_id_form").val(result.success);
                                        //$('#ctp-table').DataTable().draw();
                                        
                                    }}
                                });
                                
                                return false;
                            },
                            error: function (request, status, error) {
                                alert(error);
                                return false;
                            }});
                            
                        
                    },
                    No: function () {
                    }
                }
            });
            
            /*
            $.post('http://path/to/post', 
                $('#myForm').serialize(), 
                function(data, status, xhr){
                // do something here with response;
                });
            */
            });
        });


        $(function(){
            $('#btnModalNewClose').click(function(e){
            e.preventDefault();
            $.confirm({
                type: 'orange',
                icon: 'fa fa-warning',
                title: 'Warning',
                content: 'Record not saved, comfirm close?',
                buttons: {
                    Yes: function(yesButton){
                        $('#modalNew').modal('hide');
                        $('.modal-backdrop').remove();
                    },
                    No: function () {
                    }
                }
            });
            //$('#myModal').modal('hide')
            /*
            $.post('http://path/to/post', 
                $('#myForm').serialize(), 
                function(data, status, xhr){
                // do something here with response;
                });
            */
            });
        });
        /*
        var initialText = $('#editable_cust').val();
        $('#select_cust_no_new').val(initialText);

        $('#select_cust_no').change(function(){
            var selected = $('option:selected', this).attr('class');
            var optionText = $('#editable_cust').text();

            if(selected == "editable"){
            $('#select_cust_no_new').show();

            
            $('#select_cust_no_new').keyup(function(){
                var editText = $('#select_cust_no_new').val();
                $('#editable_cust').val(editText);
                //$('#editable_cust').html(editText);
            });

            }else{
            $('#select_cust_no_new').hide();
            }
        });

        var initialTextPart = $('#editable_part').val();
        $('#select_part_no_new').val(initialTextPart);

        $('#select_part_no').change(function(){
            var selectedPart = $('option:selected', this).attr('class');
            var optionTextPart = $('#editable_part').text();

            if(selectedPart == "editable"){
            $('#select_part_no_new').show();

            
            $('#select_part_no_new').keyup(function(){
                var editTextPart = $('#select_part_no_new').val();
                $('#editable_part').val(editTextPart);
                //$('#editable_part').html(editTextPart);
            });

            }else{
            $('#select_part_no_new').hide();
            }
        });

        var initialTextVendorType = $('#editable_type_vendor').val();
        $('#text_type_vendor_new').val(initialTextVendorType);

        $('#text_type_vendor').change(function(){
            var selectedTypeVendor = $('option:selected', this).attr('class');
            var optionTextTypeVendor= $('#editable_type_vendor').text();

            if(selectedTypeVendor == "editable"){
            $('#text_type_vendor_new').show();

            
            $('#text_type_vendor_new').keyup(function(){
                var editTextVendorType = $('#text_type_vendor_new').val();
                $('#editable_type_vendor').val(editTextVendorType);
            });

            }else{
            $('#text_type_vendor_new').hide();
            }
        });*/

        $('#select_plate_type').change(function(){
            if ($("#select_plate_type").val() == 'H'){
                $("#select_plate_size").val('790');
                $("#select_mac_no").val('Heidelberg');
            }else if ($("#select_plate_type").val() == 'R'){
                $("#select_plate_size").val('785');
                $("#select_mac_no").val('Roland');
            }else if ($("#select_plate_type").val() == 'KBA'){
                $("#select_plate_size").val('795');
                $("#select_mac_no").val('KBA');
            }else{
                $("#select_plate_size").val('');
                $("#select_mac_no").val('');
            }
            $('.selectpicker').selectpicker('refresh');
        });
        
    </script>
    {{--  [End] Modal New Scripts  --}}

    {{--  [Start] Modal Modify Scripts  --}}
    <script>
    
        $(function(){
            $('#btnPlateModify').click(function(e){
                if (selectedMoldId == undefined){
                    $.confirm({
                        type: 'red', 
                        icon: 'fa fa-exclamation-circle',
                        title: 'Error',
                        content: 'Please select a record to be modified.',
                        buttons: { OK : function (){}}
                    });
                    return false;
                }
                //alert(selectedMoldId);
                $("#modalModifyTitle").text("Modify ( ID : " + selectedMoldId + ")");


                $("#select_plate_type_modify").val(selectedMoldType);
                $("#select_plate_size_modify").val(selectedMoldSize);
                $("#text_type_vendor_modify").val(selectedMoldTypeVendor);
                $("#text_location_modify").val(selectedLocation);
                //$("#input_qty_modify").val(selectedQty);
                $("#input_qty_life_modify").val(selectedQtyLife);
                $("#text_film_desc_modify").val(selectedFilmDesc);
                $("#input_qty_film_modify").val(selectedQtyFilm);
                $("#select_print_req_modify").val(selectedPrintReq);
                $("#text_remark_modify").val(selectedRemark);

                $('.selectpicker').selectpicker('refresh');

                e.preventDefault();
                $('#modalModify').modal('show');
            });
        });

        $(function(){
            $('#btnModalModifySave').click(function(e){
               // $('#formNew').validator();
            e.preventDefault();
            e.stopPropagation();
            $.confirm({
                icon: 'fa fa-info-circle',
                title: 'Saving',
                content: 'Confirm save?',
                type: 'blue', 
                //theme: 'supervan', 
                buttons: {
                    Yes: function(yesButton){
                        
                         $.ajax({
                            url: "/ctp/modify", 
                            data: { 
                                mold_id : selectedMoldId,
                                plate_type : $('select[id="select_plate_type_modify"]').val(),
                                plate_size : $('select[id="select_plate_size_modify"]').val(),
                                type_vendor : $('select[id="text_type_vendor_modify"]').val(),
                                location : $('select[id="text_location_modify"]').val(),
                                print_req : $('select[id="select_print_req_modify"]').val(),
                                //qty : $('input[id="input_qty_modify"]').val(),
                                qty_life : $('input[id="input_qty_life_modify"]').val(),
                                film_desc : $('input[id="text_film_desc_modify"]').val(),
                                qty_film : $('input[id="input_qty_film_modify"]').val(),
                                remark : $('textarea[id="text_remark_modify"]').val(),
                                
                            },
                            success: function(result){
                                if (result.error){
                                    //alert(result.error.cust_no[0]);
                                    //alert(result.error);
                                    $.confirm({
                                        //theme: 'supervan',
                                        type: 'red', 
                                        icon: 'fa fa-exclamation-circle',
                                        title: 'Error',
                                        content: result.error,
                                        buttons: { OK : function (){}}
                                    });
                                    return false;
                                }
                                $.confirm({
                                    //theme: 'supervan',
                                    type: 'blue', 
                                    icon: 'fa fa-info-circle',
                                    title: 'Saved',
                                    content: 'Record has been saved.',
                                    buttons: { OK : function (){
                                        selectedMoldId = undefined;
                                        $('#modalModify').modal('hide');
                                        $('.modal-backdrop').remove();
                                        $('#ctp-table').DataTable().draw();
                                        
                                    }}
                                });
                                
                                return false;
                            },
                            error: function (request, status, error) {
                                alert(error);
                                return false;
                            }});
                            
                        
                    },
                    No: function () {
                    }
                }
            });
            });
        });

        $(function(){
            $('#btnModalModifyClose').click(function(e){
            e.preventDefault();
            $.confirm({
                type: 'orange',
                icon: 'fa fa-warning',
                title: 'Warning',
                content: 'Record not saved, comfirm close?',
                buttons: {
                    Yes: function(yesButton){
                        $('#modalModify').modal('hide');
                        $('.modal-backdrop').remove();
                    },
                    No: function () {
                    }
                }
            });
            });
        });
        
    </script>
    {{--  [End] Modal Modify Scripts  --}}

    {{--  [Start] Modal Delete Scripts  --}}
    <script>
    
        $(function(){
            $('#btnPlateDelete').click(function(e){
                if (selectedMoldId == undefined){
                    $.confirm({
                        type: 'red', 
                        icon: 'fa fa-exclamation-circle',
                        title: 'Error',
                        content: 'Please select a record to be deleted.',
                        buttons: { OK : function (){}}
                    });
                    return false;
                }
                $.confirm({
                    type: 'blue', 
                    icon: 'fa fa-info-circle',
                    title: 'Deleting',
                    content: 'Are you sure you want to delete ID [' + selectedMoldId + ']?',
                    buttons: { 
                        Yes: function(yesButton){
                            $.ajax({
                                url: "/ctp/delete", 
                                data: { 
                                    mold_id: selectedMoldId,
                                },
                                success: function(result){
                                    if (result.error){
                                        //alert(result.error.cust_no[0]);
                                        //alert(result.error);
                                        $.confirm({
                                            //theme: 'supervan',
                                            type: 'red', 
                                            icon: 'fa fa-exclamation-circle',
                                            title: 'Error',
                                            content: result.error,
                                            buttons: { OK : function (){}}
                                        });
                                        return false;
                                    }
                                    $.confirm({
                                        //theme: 'supervan',
                                        type: 'blue', 
                                        icon: 'fa fa-info-circle',
                                        title: 'Deleted',
                                        content: 'Record has been deleted.',
                                        buttons: { OK : function (){
                                            $.get('/ctp/selectData', function(data) {
                                                $('#select_plate_id_form').empty().append('<option></option>');
                                                $('#select_plate_id_curr_main').empty().append('<option></option>');
                                                $('#select_plate_id_new_main').empty().append('<option></option>');
                                                $.each(data.mold_id, function(index,subCatObj){
                                                    $('#select_plate_id_form').append('<option>'+subCatObj.mold_id+'</option>');
                                                    $('#select_plate_id_curr_main').append('<option>'+subCatObj.mold_id+'</option>');
                                                    $('#select_plate_id_new_main').append('<option>'+subCatObj.mold_id+'</option>');
                                                });
                                                $('.selectpicker').selectpicker('refresh');
                                                //$('#modalNew').modal('hide');
                                                //$('.modal-backdrop').remove();
                                                selectedMoldId = undefined;
                                                $('#ctp-table').DataTable().draw();
                                            });
                                            
                                            
                                        }}
                                    });
                                    return false;
                                    
                                },
                                error: function (request, status, error) {
                                    alert(error);
                                    return false;
                                }});
                        },No: function () {
                        }
                    }
                });
                return false;

            });
        });
    </script>
    {{--  [End] Modal Delete Scripts  --}}

  

    <script>
        function ModalCloseWarning(modalName){
            $.confirm({
                type: 'orange',
                icon: 'fa fa-warning',
                title: 'Warning',
                content: 'Record not saved, comfirm close?',
                buttons: {
                    Yes: function(yesButton){
                        $(modalName).modal('hide');
                        $('.modal-backdrop').remove();
                    },
                    No: function () {
                    }
                }
            });
        };
    </script>
@stop
